
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SpectralDNS &#8212; Professor Mikael Mortensen</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"TeX": {"Macros": {"bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}, "extensions": ["cancel.js", "AMSmath.js"]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/research/spectraldns';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Biomedical flows" href="biomedical.html" />
    <link rel="prev" title="Contact" href="../contact.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/portrait_large.jpg" class="logo__image only-light" alt="Professor Mikael Mortensen - Home"/>
    <script>document.write(`<img src="../../_static/portrait_large.jpg" class="logo__image only-dark" alt="Professor Mikael Mortensen - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Home
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="research.html">Short Bio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cv.html">CV</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">SpectralDNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="biomedical.html">Biomedical flows</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmc.html">Turbulent Combustion</a></li>
<li class="toctree-l1"><a class="reference internal" href="plasma.html">4DSpace</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical.html">Numerical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiphase.html">Multiphase</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/codes.html">Codes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teaching</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../teaching/teaching.html">Courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching/japan.html">Japan-Norway Partnership</a></li>
<li class="toctree-l1"><a class="reference internal" href="../teaching/students.html">Students</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/mikaem/jbhomepage/master?urlpath=tree/content/research/spectraldns.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/mikaem/jbhomepage" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/research/spectraldns.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SpectralDNS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">spectralDNS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shenfun">Shenfun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpi4py-fft">mpi4py-fft</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="spectraldns">
<h1>SpectralDNS<a class="headerlink" href="#spectraldns" title="Link to this heading">#</a></h1>
<aside class="sidebar">
<p class="sidebar-title">Rayleigh-Bénard</p>
<p><img alt="" src="https://raw.githack.com/spectralDNS/spectralutilities/master/movies/RB_200k_Warp.gif" />
<strong>Rayleigh-Bénard</strong> convection computed with spectral accuracy using a <a class="reference external" href="https://github.com/spectralDNS/spectralDNS/blob/master/demo/RayleighBenard.py">spectralDNS solver</a>.</p>
</aside>
<p>The <a class="reference external" href="https://github.com/spectralDNS">spectralDNS</a> project revolves around
implementing high-performance flow solvers in <a class="reference external" href="https://www.python.org">Python</a>, which is a modern and very
high-level programming language. The project is supported through several grants from <a class="reference external" href="https://www.hpc.kaust.edu.sa">King
Abdullahs University of Science and Technology</a>,
granting access to some of the world’s largest supercomputers. The work has
been presented at several conferences and as invited talks</p>
<ul class="simple">
<li><p><a class="reference external" href="http://tianyuan.xmu.edu.cn/activities/19-20/ICSCA2019/index.html">11’th International Conference on Scientific Computing and Applications</a></p></li>
<li><p><a class="reference external" href="https://cseconf2017.simula.no">International Conference on Computational Science and Engineering</a></p></li>
<li><p><a class="reference external" href="https://www.aices.rwth-aachen.de/en/media-and-seminars/events/mortensen-seminar">I3MS Seminar Series of the Institute for Modeling and Simulation, 6 Nov 2017 RWTH AAchen University</a></p></li>
<li><p><a class="reference external" href="https://pccfd.kaust.edu.sa/speaker?si=4">Predictive Complex Computational Fluid Dynamics, KAUST, May 2017</a></p></li>
<li><p><a class="reference external" href="http://arxiv.org/abs/1708.03188">MekIT’17 National Conference on computational Mechanics, Trondheim, May 2017</a></p></li>
<li><p><a class="reference external" href="https://www.euroscipy.org/2015/schedule/presentation/6/">EuroScipy, Cambridge, August 2015</a></p></li>
</ul>
<p>The <em>spectralDNS</em> project on github contains several repositories, each representing a smaller part of the overall project. The most important are presented beolw.</p>
<section id="id1">
<h2>spectralDNS<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><img alt="" src="https://raw.githack.com/spectralDNS/spectralutilities/master/figures/strong_scaling_pencil_col.png" /></p>
<p><strong>Strong scaling</strong> of triply periodic Navier-Stokes solver on the Shaheen II supercomputer at KAUST.</p>
</aside>
<p>The <a class="reference external" href="https://github.com/spectralDNS/spectralDNS">spectralDNS</a> repository is home to several different pseudo-spectral Navier-Stokes and MagnetoHydroDynamics solvers. Most solvers are for triply periodic domains. The simplest possible Navier-Stokes solver is described by <span id="id2">[<a class="reference internal" href="#id27" title="M. Mortensen and H. P. Langtangen. High performance Python for direct numerical simulations of turbulent flows. Computer Physics Communications, 203:53-65, 2016. doi:10.1016/j.cpc.2016.02.005.">Mortensen and Langtangen, 2016</a>]</span>, who show that a highly efficient solver can be created using no more than 100 lines of code, using nothing more than standard
tools like <em>Numpy</em> and <em>MPI for Python</em>. The DNS solver has been tested for a
transitional Taylor-Green vortex using a computational box of size <span class="math notranslate nohighlight">\(2048^3\)</span>. Accuracy is, well spectral, and in benchmark tests on the Shaheen II supercomputer at KAUST it has been found to scale well up to 64,000 cores.
A state-of-the-art spectral channel flow solver that is making extensive use of <em>shenfun</em>, has been described by <span id="id3">[<a class="reference internal" href="#id35" title="Mikael Mortensen. A spectral-galerkin turbulent channel flow solver for large-scale simulations. arXiv preprint, 2017. URL: https://arxiv.org/abs/1701.03787.">Mortensen, 2017</a>]</span>. Turbulent flow at <span class="math notranslate nohighlight">\(Re_{\tau}=2000\)</span> is shown in the movie below.</p>
<p><img alt="" src="https://raw.githack.com/spectralDNS/spectralutilities/master/movies/Re2000_cropped.gif" /></p>
<p>With colleagues at the Extreme Computing Research Center (ECRC), King Abdullah University of Science and Technology (KAUST), we have been using <a class="reference external" href="https://github.com/spectralDNS">spectralDNS</a> to investigate time integration of Fourier pseudospectral Direct Numerical Simulations <span id="id4">[<a class="reference internal" href="#id67" title="David I. Ketcheson, Mikael Mortensen, Matteo Parsani, and Nathanael Schilling. More efficient time integration for fourier pseudospectral dns of incompressible turbulence. International Journal for Numerical Methods in Fluids, 92(2):79-93, 2020. doi:10.1002/fld.4773.">Ketcheson <em>et al.</em>, 2020</a>]</span>. We investigate the use of higher‐order Runge‐Kutta pairs and automatic step size control based on local error estimation. We find that the fifth‐order accurate Runge‐Kutta pair of Bogacki and Shampine gives much greater accuracy at a significantly reduced computational cost.</p>
</section>
<section id="shenfun">
<h2>Shenfun<a class="headerlink" href="#shenfun" title="Link to this heading">#</a></h2>
<p>With the <a class="reference external" href="https://github.com/spectralDNS/shenfun">shenfun</a> Python module
<span id="id5">[<a class="reference internal" href="#id62" title="M. Mortensen. Shenfun - automating the spectral galerkin method. In In Bjørn Helge Skallerud and Helge Ingolf Andersson (ed.), MekIT'17 - Ninth national conference on Computational Mechanics. International Center for Numerical Methods in Engineering (CIMNE), 273-298. 2017. URL: https://arxiv.org/abs/1708.03188.">Mortensen, 2017</a>]</span> an
effort is made towards automating the implementation of the spectral Galerkin
method for simple tensor product domains, consisting of non-periodic and
periodic directions. The user interface to <em>shenfun</em> is intentionally made very
similar to <a class="reference external" href="https://fenicsproject.org">FEniCS</a>. Partial Differential Equations
are represented through weak variational forms and solved using efficient direct
solvers where available. MPI decomposition is achieved through the
<a class="reference external" href="https://bitbucket.org/mpi4py/mpi4py-fft">mpi4py-fft</a> module, and all developed solvers may,
with no additional effort, be run on supercomputers using thousands of
processors.</p>
<p>An introduction to <em>shenfun</em> is given in <span id="id6">[<a class="reference internal" href="#id62" title="M. Mortensen. Shenfun - automating the spectral galerkin method. In In Bjørn Helge Skallerud and Helge Ingolf Andersson (ed.), MekIT'17 - Ninth national conference on Computational Mechanics. International Center for Numerical Methods in Engineering (CIMNE), 273-298. 2017. URL: https://arxiv.org/abs/1708.03188.">Mortensen, 2017</a>]</span>, on <a class="reference external" href="https://shenfun.readthedocs.io">readthedocs</a>
and the paper <span id="id7">[<a class="reference internal" href="#id33" title="Mikael Mortensen. Shenfun: high performance spectral galerkin computing platform. Journal of Open Source Software, 3(31):1071, 2018. doi:10.21105/joss.01071.">Mortensen, 2018</a>]</span>. Shenfun is also used as PDE solver in the deep reinforcement
learning paper by <span id="id8">[<a class="reference internal" href="#id12" title="Colin Vignon, Jean Rabault, Joel Vasanth, Francisco Alcántara-Ávila, Mikael Mortensen, and Ricardo Vinuesa. Effective control of two-dimensional Rayleigh–Bénard convection: Invariant multi-agent reinforcement learning is all you need. Physics of Fluids, 35(6):065146, 06 2023. doi:10.1063/5.0153181.">Vignon <em>et al.</em>, 2023</a>]</span> and to study the Rayleigh Taylor instability <span id="id9">[<a class="reference internal" href="#id70" title="A. Piterskaya, W. J. Miloch, and M. Mortensen. A global spectral-Galerkin investigation of a Rayleigh–Taylor instability in plasma using an MHD–Boussinesq model. AIP Advances, 13(10):105319, 10 2023. doi:10.1063/5.0155976.">Piterskaya <em>et al.</em>, 2023</a>]</span>.
Introduction to <em>mpi4py-fft</em>is given <a class="reference external" href="https://mpi4py-fft.readthedocs.io/en/latest/">here</a> and
in <span id="id10">[<a class="reference internal" href="#id22" title="Lisandro Dalcin, Mikael Mortensen, and David E Keyes. Fast parallel multidimensional FFT using advanced MPI. Journal of Parallel and Distributed Computing, 2019. doi:10.1016/j.jpdc.2019.02.006.">Dalcin <em>et al.</em>, 2019</a>, <a class="reference internal" href="#id19" title="Mikael Mortensen, Lisandro Dalcin, and David Keyes. Mpi4py-fft: parallel fast fourier transforms with mpi for python. Journal of Open Source Software, 4(36):1340, 4 2019. doi:10.21105/joss.01340.">Mortensen <em>et al.</em>, 2019</a>]</span>. Further documentation is found at</p>
<p><a class="reference external" href="https://shenfun.readthedocs.io/en/latest/"><img alt="Documentation" src="https://readthedocs.org/projects/shenfun/badge/?version=latest" /></a></p>
<p>Try shenfun in the computational cell below. Modify to own liking and run interactively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">shenfun</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x,y&quot;</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;Chebyshev&#39;</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;Fourier&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TensorProductSpace</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">F</span><span class="p">))</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="n">T</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">local_mesh</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="o">.</span><span class="n">backward</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2a118da4d7c01605ee3cd12f795ac1edb0628c025fef4708c1edc29cdbaefdaf.png" src="../../_images/2a118da4d7c01605ee3cd12f795ac1edb0628c025fef4708c1edc29cdbaefdaf.png" />
</div>
</div>
</section>
<section id="mpi4py-fft">
<h2>mpi4py-fft<a class="headerlink" href="#mpi4py-fft" title="Link to this heading">#</a></h2>
<p>mpi4py-fft is a Python package for computing Fast Fourier Transforms (FFTs).
Large arrays are distributed and communications are handled under the hood by
MPI for Python (mpi4py). To distribute large arrays we are using a
<a class="reference external" href="https://arxiv.org/abs/1804.09536">new and completely generic algorithm</a>
that allows for any index set of a multidimensional array to be distributed. We
can distribute just one index (a slab decomposition), two index sets (pencil
decomposition) or even more for higher-dimensional arrays.</p>
<p>mpi4py-fft comes with its own Python interface to the serial
<a class="reference external" href="http://www.fftw.org">FFTW</a> library. This interface can be used
much like <a class="reference external" href="https://hgomersall.github.io/pyFFTW">pyfftw</a>, and even for
real-to-real transforms, like discrete cosine or sine transforms. Further documentation is found at</p>
<p><a class="reference external" href="https://mpi4py-fft.readthedocs.io/en/latest/"><img alt="Documentation" src="https://readthedocs.org/projects/mpi4py-fft/badge/?version=latest" /></a></p>
<p>Number of downloads from conda-forge:</p>
<p><a class="reference external" href="https://anaconda.org/conda-forge/mpi4py-fft"><img alt="Anaconda-Server Badge" src="https://anaconda.org/conda-forge/mpi4py-fft/badges/downloads.svg" /></a></p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id11">
<div role="list" class="citation-list">
<div class="citation" id="id22" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">DMK9}</a><span class="fn-bracket">]</span></span>
<p>Lisandro Dalcin, Mikael Mortensen, and David E Keyes. Fast parallel multidimensional FFT using advanced MPI. <em>Journal of Parallel and Distributed Computing</em>, 2019. <a class="reference external" href="https://doi.org/10.1016/j.jpdc.2019.02.006">doi:10.1016/j.jpdc.2019.02.006</a>.</p>
</div>
<div class="citation" id="id67" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">KMPS20</a><span class="fn-bracket">]</span></span>
<p>David I. Ketcheson, Mikael Mortensen, Matteo Parsani, and Nathanael Schilling. More efficient time integration for fourier pseudospectral dns of incompressible turbulence. <em>International Journal for Numerical Methods in Fluids</em>, 92(2):79–93, 2020. <a class="reference external" href="https://doi.org/10.1002/fld.4773">doi:10.1002/fld.4773</a>.</p>
</div>
<div class="citation" id="id62" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Mor17a<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>M. Mortensen. Shenfun - automating the spectral galerkin method. In <em>In Bjørn Helge Skallerud and Helge Ingolf Andersson (ed.), MekIT'17 - Ninth national conference on Computational Mechanics. International Center for Numerical Methods in Engineering (CIMNE)</em>, 273–298. 2017. URL: <a class="reference external" href="https://arxiv.org/abs/1708.03188">https://arxiv.org/abs/1708.03188</a>.</p>
</div>
<div class="citation" id="id27" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">ML16</a><span class="fn-bracket">]</span></span>
<p>M. Mortensen and H. P. Langtangen. High performance Python for direct numerical simulations of turbulent flows. <em>Computer Physics Communications</em>, 203:53–65, 2016. <a class="reference external" href="https://doi.org/10.1016/j.cpc.2016.02.005">doi:10.1016/j.cpc.2016.02.005</a>.</p>
</div>
<div class="citation" id="id35" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Mor17b</a><span class="fn-bracket">]</span></span>
<p>Mikael Mortensen. A spectral-galerkin turbulent channel flow solver for large-scale simulations. <em>arXiv preprint</em>, 2017. URL: <a class="reference external" href="https://arxiv.org/abs/1701.03787">https://arxiv.org/abs/1701.03787</a>.</p>
</div>
<div class="citation" id="id33" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">Mor18</a><span class="fn-bracket">]</span></span>
<p>Mikael Mortensen. Shenfun: high performance spectral galerkin computing platform. <em>Journal of Open Source Software</em>, 3(31):1071, 2018. <a class="reference external" href="https://doi.org/10.21105/joss.01071">doi:10.21105/joss.01071</a>.</p>
</div>
<div class="citation" id="id19" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">MDK19</a><span class="fn-bracket">]</span></span>
<p>Mikael Mortensen, Lisandro Dalcin, and David Keyes. Mpi4py-fft: parallel fast fourier transforms with mpi for python. <em>Journal of Open Source Software</em>, 4(36):1340, 4 2019. <a class="reference external" href="https://doi.org/10.21105/joss.01340">doi:10.21105/joss.01340</a>.</p>
</div>
<div class="citation" id="id70" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">PMM23</a><span class="fn-bracket">]</span></span>
<p>A. Piterskaya, W. J. Miloch, and M. Mortensen. A global spectral-Galerkin investigation of a Rayleigh–Taylor instability in plasma using an MHD–Boussinesq model. <em>AIP Advances</em>, 13(10):105319, 10 2023. <a class="reference external" href="https://doi.org/10.1063/5.0155976">doi:10.1063/5.0155976</a>.</p>
</div>
<div class="citation" id="id12" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">VRV+23</a><span class="fn-bracket">]</span></span>
<p>Colin Vignon, Jean Rabault, Joel Vasanth, Francisco Alcántara-Ávila, Mikael Mortensen, and Ricardo Vinuesa. Effective control of two-dimensional Rayleigh–Bénard convection: Invariant multi-agent reinforcement learning is all you need. <em>Physics of Fluids</em>, 35(6):065146, 06 2023. <a class="reference external" href="https://doi.org/10.1063/5.0153181">doi:10.1063/5.0153181</a>.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mikaem/jbhomepage",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/research"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../contact.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Contact</p>
      </div>
    </a>
    <a class="right-next"
       href="biomedical.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Biomedical flows</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">spectralDNS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shenfun">Shenfun</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpi4py-fft">mpi4py-fft</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mikael Mortensen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>